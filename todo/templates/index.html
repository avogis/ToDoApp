<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>To Do</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>
<body>

<form method="post" id="get_name">
    {% csrf_token %}
        <div id="the_post">
            {{ form }}
            <input type="submit" value="Submit" />
        </div>
</form>

<ul id="todos">
{% if todo_list %}

    {% for todo in todo_list %}
        <li class="{{todo.id}}" >{{ todo.todo_text }}</li><p class="{{todo.id}}" onclick="delete_todo({{todo.id}})" >delete</p>
    {% endfor %}

{% endif %}
</ul>

<p id="no_todo"></p>

<script>
    function delete_todo(id) {
        $("#no_todo").text("");
        console.log("delete is working!") // sanity check
        $.ajax({
            url : "delete_todo/", // the endpoint
            type : "POST", // http method
            data : { the_post : id }, // data sent with the post request
            // handle a successful response
            success : function(json) {
                console.log($("."+id))
                $("."+id).remove()
                console.log("success"); // another sanity check
            },
            // handle a non-successful response
            error : function(xhr,errmsg,err) {
                $('#results').html("<div>Oops! We have encountered an error: "+errmsg+
                    " <a href='#' class='close'>&times;</a></div>"); // add the error to the dom
                console.log(xhr.status + ": " + xhr.responseText); // provide a bit more info about the error to the console
            }
        });
    };
</script>
<script type="text/javascript" src="/static/scripts/main.js"></script>


</body>
</html>